<!DOCTYPE html><html class=writer-html5 lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content="CCR Collaborative Bioinformatics Resource"><link rel="shortcut icon" href=../../img/favicon.ico><title>Introduction - CHAMPAGNE</title><link rel=stylesheet href=../../css/theme.css><link rel=stylesheet href=../../css/theme_extra.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css><link href=../../css/custom.css rel=stylesheet><link href=../../css/version-select.css rel=stylesheet><script>
        // Current page data
        var mkdocs_page_name = "Introduction";
        var mkdocs_page_input_path = "guide/intro.md";
        var mkdocs_page_url = null;
      </script><!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]--><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js></script><script>hljs.highlightAll();</script></head> <body class=wy-body-for-nav role=document> <div class=wy-grid-for-nav> <nav data-toggle=wy-nav-shift class="wy-nav-side stickynav"> <div class=wy-side-scroll> <div class=wy-side-nav-search> <a href=../.. class="icon icon-home"> CHAMPAGNE </a><div role=search> <form id=rtd-search-form class=wy-form action=../../search.html method=get> <input type=text name=q placeholder="Search docs" aria-label="Search docs" title="Type search term here"> </form> </div> </div> <div class="wy-menu wy-menu-vertical" data-spy=affix role=navigation aria-label="Navigation menu"> <ul> <li class=toctree-l1><a class="reference internal" href=../..>Home</a> </li> </ul> <p class=caption><span class=caption-text>User Guide</span></p> <ul class=current> <li class="toctree-l1 current"><a class="reference internal current" href=#>Introduction</a> <ul class=current> <li class=toctree-l2><a class="reference internal" href=#input-validation-input_check>Input Validation [INPUT_CHECK]</a> </li> <li class=toctree-l2><a class="reference internal" href=#adapter-trimming-cutadapt>Adapter Trimming [CUTADAPT]</a> </li> <li class=toctree-l2><a class="reference internal" href=#input-pooling-pool_inputs>Input Pooling [POOL_INPUTS]</a> </li> <li class=toctree-l2><a class="reference internal" href=#genome-preparation-prepare_genome>Genome Preparation [PREPARE_GENOME]</a> </li> <li class=toctree-l2><a class="reference internal" href=#blacklist-filtering-filter_blacklist>Blacklist Filtering [FILTER_BLACKLIST]</a> </li> <li class=toctree-l2><a class="reference internal" href=#genome-alignment-align_genome>Genome Alignment [ALIGN_GENOME]</a> </li> <li class=toctree-l2><a class="reference internal" href=#deduplication-deduplicate>Deduplication [DEDUPLICATE]</a> </li> <li class=toctree-l2><a class="reference internal" href=#quality-metrics-phantom_peaks>Quality Metrics [PHANTOM_PEAKS]</a> </li> <li class=toctree-l2><a class="reference internal" href=#quality-control-qc>Quality Control [QC]</a> </li> <li class=toctree-l2><a class="reference internal" href=#spike-in-normalization-align_spikein-optional>Spike-in Normalization [ALIGN_SPIKEIN] (Optional)</a> </li> <li class=toctree-l2><a class="reference internal" href=#genome-coverage-visualization-deeptools>Genome Coverage Visualization [DEEPTOOLS]</a> </li> <li class=toctree-l2><a class="reference internal" href=#peak-calling-call_peaks>Peak Calling [CALL_PEAKS]</a> </li> <li class=toctree-l2><a class="reference internal" href=#consensus-peak-calling-optional>Consensus Peak Calling (Optional)</a> <ul> <li class=toctree-l3><a class="reference internal" href=#union-method-consensus_union>Union Method [CONSENSUS_UNION]</a> </li> <li class=toctree-l3><a class="reference internal" href=#corces-method-consensus_corces>Corces Method [CONSENSUS_CORCES]</a> </li> </ul> </li> <li class=toctree-l2><a class="reference internal" href=#peak-annotation-annotate>Peak Annotation [ANNOTATE]</a> </li> <li class=toctree-l2><a class="reference internal" href=#motif-discovery-motifs>Motif Discovery [MOTIFS]</a> </li> <li class=toctree-l2><a class="reference internal" href=#differential-analysis-diff-optional>Differential Analysis [DIFF] (Optional)</a> </li> <li class=toctree-l2><a class="reference internal" href=#quality-report-aggregation-multiqc>Quality Report Aggregation [MULTIQC]</a> </li> </ul> </li> <li class=toctree-l1><a href=../usage/ class="reference internal">Usage</a> </li> <li class=toctree-l1><a href=../output/ class="reference internal">Output</a> </li> <li class=toctree-l1><a href=../params/ class="reference internal">Parameters</a> </li> <li class=toctree-l1><a href=../genomes/ class="reference internal">Genomes</a> </li> <li class=toctree-l1><a href=../spike-in/ class="reference internal">Spike-in Normalization</a> </li> <li class=toctree-l1><a href=../troubleshooting/ class="reference internal">Troubleshooting</a> </li> </ul> <p class=caption><span class=caption-text>Developer Guide</span></p> <ul> <li class=toctree-l1><a href=../../devs/contributing/ class="reference internal">How to contribute</a> </li> <li class=toctree-l1><a href=../../devs/contributors/ class="reference internal">Contributors</a> </li> </ul> <ul> <li class=toctree-l1><a href=../../changelog/ class="reference internal">Changelog</a> </li> </ul> </div> </div> </nav> <section data-toggle=wy-nav-shift class=wy-nav-content-wrap> <nav class=wy-nav-top role=navigation aria-label="Mobile navigation menu"> <i data-toggle=wy-nav-top class="fa fa-bars"></i> <a href=../..>CHAMPAGNE</a> </nav> <div class=wy-nav-content> <div class=rst-content><div role=navigation aria-label="breadcrumbs navigation"> <ul class=wy-breadcrumbs> <li><a href=../.. class="icon icon-home" aria-label=Docs></a></li> <li class=breadcrumb-item>User Guide</li> <li class="breadcrumb-item active">Introduction</li> <li class=wy-breadcrumbs-aside> <a href=https://github.com/CCBR/CHAMPAGNE/edit/main/guide/intro.md>Edit on CCBR/CHAMPAGNE</a> </li> </ul> <hr> </div> <div role=main class=document itemscope=itemscope itemtype=http://schema.org/Article> <div class=section itemprop=articleBody> <h1 id=champagne-workflow-overview>CHAMPAGNE Workflow Overview<a class=headerlink href=#champagne-workflow-overview title="Permanent link">&para;</a></h1> <p><img alt="Workflow Diagram" src=../../diagram/workflow.svg></p> <p>CHAMPAGNE is a comprehensive ChIP-seq analysis pipeline that integrates multiple preprocessing, quality control, peak calling, annotation, and downstream analysis steps. Below is a detailed breakdown of each workflow stage.</p> <h2 id=input-validation-input_check>Input Validation [INPUT_CHECK]<a class=headerlink href=#input-validation-input_check title="Permanent link">&para;</a></h2> <p>Validates the sample sheet and contrast sheet to ensure the samples and contrasts names are defined correctly.</p> <h2 id=adapter-trimming-cutadapt>Adapter Trimming [CUTADAPT]<a class=headerlink href=#adapter-trimming-cutadapt title="Permanent link">&para;</a></h2> <p>Removes sequencing adapters and low-quality bases from raw reads.</p> <h2 id=input-pooling-pool_inputs>Input Pooling [POOL_INPUTS]<a class=headerlink href=#input-pooling-pool_inputs title="Permanent link">&para;</a></h2> <p>Concatenates trimmed reads from multiple input files belonging to the same sample.</p> <h2 id=genome-preparation-prepare_genome>Genome Preparation [PREPARE_GENOME]<a class=headerlink href=#genome-preparation-prepare_genome title="Permanent link">&para;</a></h2> <p>Prepares genome information for a custom genome when given a fasta &amp; gtf file.</p> <ul> <li>Generates reference genome files and indices</li> <li>Creates chromosome sizes, effective genome size, blacklist regions, and other reference data</li> <li>Outputs annotation files for downstream use</li> </ul> <h2 id=blacklist-filtering-filter_blacklist>Blacklist Filtering [FILTER_BLACKLIST]<a class=headerlink href=#blacklist-filtering-filter_blacklist title="Permanent link">&para;</a></h2> <p>Removes reads mapping to known problematic genomic regions (blacklisted regions).</p> <h2 id=genome-alignment-align_genome>Genome Alignment [ALIGN_GENOME]<a class=headerlink href=#genome-alignment-align_genome title="Permanent link">&para;</a></h2> <ul> <li>Aligns reads to reference genome using BWA</li> <li>Filters alignments by quality score</li> <li>Sorts BAM files for downstream processing</li> <li>Generates flagstat metrics at alignment and filtering stages</li> </ul> <h2 id=deduplication-deduplicate>Deduplication [DEDUPLICATE]<a class=headerlink href=#deduplication-deduplicate title="Permanent link">&para;</a></h2> <ul> <li>Removes PCR duplicates using MACS2 filterdup (single-end) or Picard MarkDuplicates (paired-end)</li> <li>Converts BAM files to tag-align format for MACS2/SICER peak calling</li> <li>Maintains BAM/BAMPE format for GEM peak calling</li> <li>Generates flagstat metrics for quality assessment</li> </ul> <h2 id=quality-metrics-phantom_peaks>Quality Metrics [PHANTOM_PEAKS]<a class=headerlink href=#quality-metrics-phantom_peaks title="Permanent link">&para;</a></h2> <ul> <li>Calculates fragment length estimates and quality metrics using PhantomPeaks</li> <li>Assesses library complexity and cross-correlation</li> </ul> <h2 id=quality-control-qc>Quality Control [QC]<a class=headerlink href=#quality-control-qc title="Permanent link">&para;</a></h2> <ul> <li>Runs FastQC on raw and trimmed reads for sequence quality assessment</li> <li>Runs FASTQ_SCREEN for contamination detection</li> <li>Estimates library complexity using PRESEQ</li> <li>Compiles alignment and deduplication statistics</li> <li>Generates comprehensive QC report for MultiQC</li> </ul> <h2 id=spike-in-normalization-align_spikein-optional>Spike-in Normalization [ALIGN_SPIKEIN] <em>(Optional)</em><a class=headerlink href=#spike-in-normalization-align_spikein-optional title="Permanent link">&para;</a></h2> <p>Aligns reads to spike-in genome (e.g. Drosophila) for exogenous normalization and calculates normalization scaling factors using either the Guenther or deLorenzi method. See <a href=../spike-in/ >the spike-in normalization page</a> for more details.</p> <h2 id=genome-coverage-visualization-deeptools>Genome Coverage Visualization [DEEPTOOLS]<a class=headerlink href=#genome-coverage-visualization-deeptools title="Permanent link">&para;</a></h2> <ul> <li>Generates genome-wide coverage bigWig files</li> <li>Creates input-normalized bigWig files (background subtraction)</li> <li>Produces correlation matrices and heatmaps</li> <li>Calculates fingerprint plots for quality assessment</li> </ul> <h2 id=peak-calling-call_peaks>Peak Calling [CALL_PEAKS]<a class=headerlink href=#peak-calling-call_peaks title="Permanent link">&para;</a></h2> <ul> <li>Identifies enriched regions using multiple peak-calling algorithms:<ul> <li>MACS2 (broad and narrow)</li> <li>GEM</li> <li>SICER</li> </ul> </li> <li>Calculates fraction of reads in peaks (FRiP) for quality assessment</li> <li>Computes Jaccard index for peak overlap between samples</li> <li>Analyzes peak width distributions</li> <li>Outputs peak files in BED format</li> </ul> <h2 id=consensus-peak-calling-optional>Consensus Peak Calling <em>(Optional)</em><a class=headerlink href=#consensus-peak-calling-optional title="Permanent link">&para;</a></h2> <h3 id=union-method-consensus_union>Union Method [CONSENSUS_UNION]<a class=headerlink href=#union-method-consensus_union title="Permanent link">&para;</a></h3> <ul> <li>Merges peaks across replicates using union approach</li> <li>Retains all peaks detected in any replicate</li> <li>Annotates and performs motif analysis on consensus peaks</li> </ul> <h3 id=corces-method-consensus_corces>Corces Method [CONSENSUS_CORCES]<a class=headerlink href=#corces-method-consensus_corces title="Permanent link">&para;</a></h3> <ul> <li>Merges peaks using the Corces algorithm (based on peak summits)</li> <li>More stringent consensus approach</li> <li>Annotates and performs motif analysis on consensus peaks</li> </ul> <h2 id=peak-annotation-annotate>Peak Annotation [ANNOTATE]<a class=headerlink href=#peak-annotation-annotate title="Permanent link">&para;</a></h2> <p>Uses ChIPseeker to assign genomic features to peaks and identify nearest genes</p> <h2 id=motif-discovery-motifs>Motif Discovery [MOTIFS]<a class=headerlink href=#motif-discovery-motifs title="Permanent link">&para;</a></h2> <p>Generates motif predictions and enrichment statistics and identifies transcription factors likely binding at detected peaks.</p> <ul> <li>HOMER performs reference and de novo motif discovery in peak sequences</li> <li>MEME-AME performs known motif enrichment analysis against genomic motif databases</li> </ul> <h2 id=differential-analysis-diff-optional>Differential Analysis [DIFF] <em>(Optional)</em><a class=headerlink href=#differential-analysis-diff-optional title="Permanent link">&para;</a></h2> <p>Performs differential binding analysis when contrasts are provided using one of two methods:</p> <ul> <li>DiffBind, used when each sample has at least 2 replicates</li> <li>MAnorm, used when any sample has only 1 replicate</li> </ul> <h2 id=quality-report-aggregation-multiqc>Quality Report Aggregation [MULTIQC]<a class=headerlink href=#quality-report-aggregation-multiqc title="Permanent link">&para;</a></h2> <p>Compiles all quality metrics and statistics into an interactive HTML report summarizing all pipeline results</p> </div> </div><script async src="https://www.googletagmanager.com/gtag/js?id=G-D3SL9V30KL"></script> <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-D3SL9V30KL'); // Replace with your tracking ID
</script> </div> </div> </section> </div> <div class=rst-versions role=note aria-label=Versions> <span class=rst-current-version data-toggle=rst-current-version> <span> <a href=https://github.com/CCBR/CHAMPAGNE class="fa fa-code-fork" style="color: #fcfcfc"> CCBR/CHAMPAGNE</a> </span> <span><a href=../.. style="color: #fcfcfc">&laquo; Previous</a></span> <span><a href=../usage/ style="color: #fcfcfc">Next &raquo;</a></span> </span> </div> <script src=../../js/jquery-3.6.0.min.js></script> <script>var base_url = "../..";</script> <script src=../../js/theme_extra.js></script> <script src=../../js/theme.js></script> <script src=../../js/custom.js></script> <script src=../../search/main.js></script> <script src=../../js/version-select.js></script> <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script> </body> </html> 